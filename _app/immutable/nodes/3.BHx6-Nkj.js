import{s as P,b as V,i as Z,k as x,n as R,r as ee,c as J,o as ie}from"../chunks/scheduler.CfH2YMek.js";import{S as F,i as G,k as q,l as M,a as _,d as v,g as I,B as te,e as B,s as D,c as A,f as T,n as g,h as $,r as p,v as O,q as U,p as y,D as ce,E as K,x as le,y as ne,z as se,A as re}from"../chunks/index.Cf0r2nA0.js";import{b as k}from"../chunks/paths.BmKz8GoV.js";import{i as N}from"../chunks/inline-svg.action.CPrgV8CR.js";import{w as j,d as ue}from"../chunks/index.C5hTy8eg.js";import{f as oe}from"../chunks/index.BGTp2OyQ.js";function L(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function fe(t){let e,l,n,r,i;return{c(){e=q("svg")},l(s){e=M(s,"svg",{}),_(e).forEach(v)},m(s,a){I(s,e,a),r||(i=V(l=N.call(null,e,`${k}/images/counter-${t[0]}-large.svg`)),r=!0)},p(s,[a]){l&&Z(l.update)&&a&1&&l.update.call(null,`${k}/images/counter-${s[0]}-large.svg`)},i(s){s&&(n||x(()=>{n=te(e,oe,{y:-1e3,duration:600}),n.start()}))},o:R,d(s){s&&v(e),r=!1,i()}}}function me(t,e,l){let{color:n}=e;return t.$$set=r=>{"color"in r&&l(0,n=r.color)},[n]}class de extends F{constructor(e){super(),G(this,e,me,fe,P,{color:0})}}const ge=Array(7*6).fill(void 0),{set:De,update:he,subscribe:ve}=j(ge),pe={subscribe:ve};function _e(t){return new Promise(e=>{he(l=>{const n=[...l],r=l.map((i,s)=>({value:i,column:s%7,index:s})).filter(i=>i.column===t.indexColumn&&i.value===void 0).pop();return r?(n[r.index]=t.color,e(!0),n):(e(!1),l)})})}function Q(t,e,l){const n=t.slice();return n[10]=e[l],n[12]=l,n}function W(t){let e,l;return e=new de({props:{color:t[2][t[12]]}}),{c(){le(e.$$.fragment)},l(n){ne(e.$$.fragment,n)},m(n,r){se(e,n,r),l=!0},p(n,r){const i={};r&4&&(i.color=n[2][n[12]]),e.$set(i)},i(n){l||(p(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){re(e,n)}}}function X(t){let e,l,n,r,i,s=t[2][t[12]]&&W(t);return{c(){e=B("button"),s&&s.c(),l=D(),this.h()},l(a){e=A(a,"BUTTON",{class:!0,id:!0,role:!0,tabindex:!0});var u=_(e);s&&s.l(u),l=T(u),u.forEach(v),this.h()},h(){g(e,"class","cell"),g(e,"id",`board-cell-${t[12]}`),g(e,"role","cell"),g(e,"tabindex","0")},m(a,u){I(a,e,u),s&&s.m(e,null),$(e,l),n=!0,r||(i=[K(e,"mouseenter",t[5](t[12])),K(e,"click",t[6](t[12]))],r=!0)},p(a,u){t=a,t[2][t[12]]?s?(s.p(t,u),u&4&&p(s,1)):(s=W(t),s.c(),p(s,1),s.m(e,l)):s&&(O(),y(s,1,1,()=>{s=null}),U())},i(a){n||(p(s),n=!0)},o(a){y(s),n=!1},d(a){a&&v(e),s&&s.d(),r=!1,ee(i)}}}function Y(t){let e,l,n,r,i,s;return{c(){e=q("svg"),this.h()},l(a){e=M(a,"svg",{style:!0,width:!0,height:!0}),_(e).forEach(v),this.h()},h(){g(e,"style",l=`grid-area: cell-${t[3].column}`),g(e,"width","38"),g(e,"height","30")},m(a,u){I(a,e,u),i||(s=V(n=N.call(null,e,k+"/images/marker-"+t[1]+".svg")),i=!0)},p(a,u){t=a,u&8&&l!==(l=`grid-area: cell-${t[3].column}`)&&g(e,"style",l),n&&Z(n.update)&&u&2&&n.update.call(null,k+"/images/marker-"+t[1]+".svg")},i(a){a&&(r||x(()=>{r=te(e,oe,{x:-t[0],duration:ae,opacity:1}),r.start()}))},o:R,d(a){a&&v(e),i=!1,s()}}}function be(t){let e,l,n,r,i,s,a,u,E=t[3].column,C,b,S,d=L(Array(7*6)),o=[];for(let c=0;c<d.length;c+=1)o[c]=X(Q(t,d,c));const z=c=>y(o[c],1,1,()=>{o[c]=null});let h=Y(t);return{c(){e=B("div"),l=q("svg"),n=D(),r=B("div");for(let c=0;c<o.length;c+=1)o[c].c();i=D(),s=q("svg"),a=D(),u=B("div"),h.c(),this.h()},l(c){e=A(c,"DIV",{class:!0});var f=_(e);l=M(f,"svg",{class:!0,height:!0}),_(l).forEach(v),n=T(f),r=A(f,"DIV",{class:!0});var m=_(r);for(let H=0;H<o.length;H+=1)o[H].l(m);m.forEach(v),i=T(f),s=M(f,"svg",{class:!0}),_(s).forEach(v),a=T(f),u=A(f,"DIV",{class:!0});var w=_(u);h.l(w),w.forEach(v),f.forEach(v),this.h()},h(){g(l,"class","shadow"),g(l,"height","594"),g(r,"class","cells"),g(s,"class","overlay"),g(u,"class","board-cursor"),g(e,"class","board svelte-1e4pdv4")},m(c,f){I(c,e,f),$(e,l),$(e,n),$(e,r);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(r,null);$(e,i),$(e,s),$(e,a),$(e,u),h.m(u,null),C=!0,b||(S=[V(N.call(null,l,k+"/images/board-layer-black-large.svg")),V(N.call(null,s,k+"/images/board-layer-white-large.svg"))],b=!0)},p(c,[f]){if(f&100){d=L(Array(7*6));let m;for(m=0;m<d.length;m+=1){const w=Q(c,d,m);o[m]?(o[m].p(w,f),p(o[m],1)):(o[m]=X(w),o[m].c(),p(o[m],1),o[m].m(r,null))}for(O(),m=d.length;m<o.length;m+=1)z(m);U()}f&8&&P(E,E=c[3].column)?(O(),y(h,1,1,R),U(),h=Y(c),h.c(),p(h,1),h.m(u,null)):h.p(c,f)},i(c){if(!C){for(let f=0;f<d.length;f+=1)p(o[f]);p(h),C=!0}},o(c){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)y(o[f]);y(h),C=!1},d(c){c&&v(e),ce(o,c),h.d(c),b=!1,ee(S)}}}let ae=200;function $e(t,e,l){let n,r;J(t,pe,d=>l(2,n=d));const i=j(0),s=j(0);let a=0;const u=ue([i,s],([d,o])=>({column:d,prevColumn:o}));J(t,u,d=>l(3,r=d)),ie(()=>{u.subscribe(({column:d,prevColumn:o})=>{const z=document.getElementById(`board-cell-${o}`).getClientRects()[0],h=document.getElementById(`board-cell-${d}`).getClientRects()[0];l(0,a=h.x-z.x)})});let E;function C(d){return()=>{clearTimeout(E),E=setTimeout(()=>{i.update(o=>(s.set(o),d%7))},ae*.75)}}let b="red";function S(d){return async o=>{await _e({indexColumn:d%7,color:b})&&l(1,b=b==="red"?"yellow":"red")}}return[a,b,n,r,u,C,S]}class ye extends F{constructor(e){super(),G(this,e,$e,be,P,{})}}function Ce(t){let e,l,n;return l=new ye({}),{c(){e=B("main"),le(l.$$.fragment),this.h()},l(r){e=A(r,"MAIN",{class:!0});var i=_(e);ne(l.$$.fragment,i),i.forEach(v),this.h()},h(){g(e,"class","svelte-bts22h")},m(r,i){I(r,e,i),se(l,e,null),n=!0},p:R,i(r){n||(p(l.$$.fragment,r),n=!0)},o(r){y(l.$$.fragment,r),n=!1},d(r){r&&v(e),re(l)}}}function ke(t){return[]}class Te extends F{constructor(e){super(),G(this,e,ke,Ce,P,{})}}export{Te as component};
